(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7800],{2121:function(e,a,t){Promise.resolve().then(t.bind(t,6239))},6239:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return A}});var r=t(9268),s=t(6006),l=t(2985),n=t(7808),d=t(9442),i=t(9700),o=t(1712),u=t(63),c=t(4496);t(6760);var m=t(1468),h=t(6008),p=e=>{let{register:a,errors:t,control:l,dtEdit:n,watch:d,setValue:i,showModal:p}=e,f=o.Z.get("dosen_id"),g=(0,h.useSearchParams)(),x=g.get("semester")||"",b=g.get("year")||"",{setJadwalByDosenFull:w,dtJadwal:v}=(0,m.Z)(),j=async()=>{await w({tahun:b,semester:x,dosen_id:f})};return(0,s.useEffect)(()=>{b&&x&&j()},[p,b,x]),(0,r.jsxs)(r.Fragment,{children:[(null==v?void 0:v.data)&&(0,r.jsx)(c.Z,{label:"Jadwal",placeholder:"Pilih Jadwal",name:"jadwal_id",dataDb:null==v?void 0:v.data,body:["id","prodi.singkat","hari","matkul.nm_matkul","mulai","seles"],control:l,required:!0,errors:t.jadwal_id,addClass:"col-span-4"}),(0,r.jsx)(u.Z,{label:"Absen",name:"file",register:a,accept:"application/pdf",required:!0,errors:t.file,addClass:"col-span-4",setValue:i,fileEdit:null==n?void 0:n.file,watch:d})]})},f=t(2775),g=t(593),x=t(541),b=e=>{let{showModal:a,setShowModal:t,dtEdit:u}=e,c=o.Z.get("dosen_id"),m=(0,h.useSearchParams)(),b=m.get("semester")||"",w=m.get("year")||"",{addData:v,updateData:j,setAbsen:y}=(0,f.Z)(),[S,Z]=(0,s.useState)(!1),{register:k,handleSubmit:_,setValue:N,control:A,formState:{errors:P},watch:T}=(0,i.cI)(),C=()=>{N("id",""),N("jadwal_id",""),N("file","")};(0,s.useEffect)(()=>{u?(N("id",u.id),N("jadwal_id",parseInt(u.jadwal_id)),N("file",u.file)):C()},[a,u]);let F=async e=>{if(Z(!0),u){let{data:a}=await j(u.id,e);(0,d.Z)({event:a}),t(!1)}else{let{data:a}=await v(e);console.log({data:a}),(0,d.Z)({event:a}),(null==a?void 0:a.type)!=="success"||C()}await y({semester:b,tahun:w,dosen_id:c}),Z(!1)};return(0,r.jsx)(n.Z,{title:"Form Absen",showModal:a,setShowModal:t,children:(0,r.jsxs)("form",{onSubmit:_(F),children:[(0,r.jsx)(l.Z,{name:"id",register:k,type:"hidden"}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,r.jsx)(p,{register:k,errors:P,dtEdit:u,control:A,watch:T,setValue:N,showModal:a})}),(0,r.jsx)("div",{children:S?(0,r.jsx)(g.Z,{}):(0,r.jsx)(x.Z,{onClick:_(F),children:"Simpan"})})]})})},w=t(686),v=t(8919),j=t(3346),y=e=>{let{setDelete:a,setEdit:t}=e,l=o.Z.get("dosen_id")||"",{setAbsen:n,dtAbsen:d}=(0,f.Z)(),[i,u]=(0,s.useState)(1),[c,m]=(0,s.useState)(10),[p,x]=(0,s.useState)(!0),b=(0,h.useSearchParams)(),w=(0,h.useSearchParams)().get("cari")||"",v=b.get("semester")||"",y=b.get("year")||"",S=(0,s.useCallback)(async()=>{x(!0),await n({search:w,semester:v,tahun:y,dosen_id:l}),x(!1)},[l,w,v,n,y]);return(0,s.useEffect)(()=>{v&&y&&S()},[S,v,y]),(0,r.jsx)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:p?(0,r.jsx)(g.Z,{}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"",children:(0,r.jsx)(j.Z,{headTable:["No","Hari","Mata Kuliah","Kode MK","JML. SKS","ABSEN","Aksi"],tableBodies:["jadwal.hari","jadwal.matkul.nama","jadwal.matkul.kode","jadwal.matkul.sks","file"],dataTable:null==d?void 0:d.data,page:i,limit:c,setEdit:t,setDelete:a,hapus:!0,ubah:!0})})})})},S=t(5858),Z=t(1852),k=t(9247),_=t(4407),N=e=>{let{halaman:a}=e,{register:t,formState:{errors:s},setValue:l,watch:n,control:d}=(0,i.cI)(),o=n("semester"),u=n("year");return(0,r.jsxs)("div",{className:"grid grid-cols-8 gap-2 w-full",children:[(0,r.jsx)(Z.Z,{setValue:l,yearWatch:u,time:1e3}),(0,r.jsx)(S.Z,{setValue:l,semesterWatch:o,time:500}),(0,r.jsx)(k.Z,{placeholder:"Pilih Semester",control:d,name:"semester",options:[{value:"Ganjil",label:"Ganjil"},{value:"Genap",label:"Genap"}],errors:s.semester,addClass:"col-span-8 md:col-span-2 text-black",menuPosition:"absolute"}),(0,r.jsx)(_.Z,{name:"year",placeholder:"Pilih Tahun",start:new Date().getFullYear()-2,end:new Date().getFullYear(),fromMax:!0,control:d,addClass:"col-span-8 md:col-span-2 text-black",menuPosition:"absolute"})]})},A=()=>{let{removeData:e}=(0,f.Z)(),[a,t]=(0,s.useState)(!1),[l,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)(),[u,c]=(0,s.useState)(),m=async a=>{let{id:t,isDelete:r}=a;if(o(t),r){let{data:a}=await e(i);(0,d.Z)({event:a}),n(!1)}else n(!0)};return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(v.Toaster,{}),(0,r.jsx)(b,{dtEdit:u,showModal:a,setShowModal:t}),(0,r.jsx)(w.Z,{showDel:l,setShowDel:n,setDelete:m}),(0,r.jsxs)("div",{className:"mb-4 flex justify-between ml-8 lg:ml-0",children:[(0,r.jsx)("p",{children:"Silahkan mengolah data absen"}),(0,r.jsx)("div",{children:(0,r.jsx)(x.Z,{onClick:()=>{t(!0),c(null)},children:"Tambah Absen"})})]}),(0,r.jsx)("div",{children:(0,r.jsx)(N,{halaman:"Absen"})})]}),(0,r.jsx)(y,{setDelete:m,setEdit:e=>{t(!0),c(e)}})]})}},5858:function(e,a,t){"use strict";var r=t(9268),s=t(9099),l=t(6008),n=t(6006);a.Z=e=>{let{semesterWatch:a,setValue:t,time:d}=e,i=(0,l.useRouter)(),o=()=>{let e=window.location.href,a=new URL(e),t=new URLSearchParams(a.search),r=t.get("semester");return{url:a,params:t,semesterParams:r}},u=e=>{let{url:a,params:t}=o();t.delete("semester"),t.append("semester",e),a.search=t.toString(),i.push(a.toString())};return(0,n.useEffect)(()=>(setTimeout(()=>{let{semesterParams:e}=o();if(e)t("semester",e);else{let e=(0,s.w)().month()+1;t("semester",e>6?"Ganjil":"Genap")}},d),()=>{}),[]),(0,n.useEffect)(()=>(a?u(a.toString()):u(""),()=>{}),[a]),(0,r.jsx)(r.Fragment,{})}},1852:function(e,a,t){"use strict";var r=t(9268),s=t(6008),l=t(6006);a.Z=e=>{let{yearWatch:a,setValue:t,time:n}=e,d=(0,s.useRouter)(),i=()=>{let e=window.location.href,a=new URL(e),t=new URLSearchParams(a.search),r=t.get("year");return{url:a,params:t,yearParams:r}},o=e=>{let{url:a,params:t}=i();t.delete("year"),t.append("year",e.toString()),a.search=t.toString(),d.push(a.toString())};return(0,l.useEffect)(()=>(setTimeout(()=>{let{yearParams:e}=i();if(e)t("year",parseInt(e));else{let e=new Date().getFullYear();t("year",e)}},n),()=>{}),[]),(0,l.useEffect)(()=>(a?o(a.toString()):o(""),()=>{}),[a]),(0,r.jsx)(r.Fragment,{})}},63:function(e,a,t){"use strict";var r=t(9268),s=t(3415),l=t(6394),n=t.n(l),d=t(6006),i=t(5883),o=t.n(i);a.Z=e=>{let{label:a,register:t,required:l,name:i,errors:u,addClass:c,accept:m,setValue:h,fileEdit:p,initialValue:f,watch:g}=e,[x,b]=(0,d.useState)(),[w,v]=(0,d.useState)(f||""),j=g(i);(0,d.useEffect)(()=>{j||v("")},[j]);let y=e=>new Promise(()=>{if(e){var a;let t=(null==e?void 0:null===(a=e.type)||void 0===a?void 0:a.split("/"))||[],r=t[0];if("image"!==r)return S(e);o().imageFileResizer(e,1500,1500,t[1],80,0,e=>{S(e)},"file")}else S(null)}),S=e=>{var a;if(e){let a=new FileReader;a.readAsDataURL(e),a.onloadend=()=>{v(a.result)}}let t=(null==e?void 0:null===(a=e.type)||void 0===a?void 0:a.split("/"))||[];b(t[0]),h(i,e)};return(0,r.jsxs)("div",{className:c,children:[a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:a}),l&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),!l&&(0,r.jsx)("span",{className:"ml-1 text-gray-500 text-sm",children:"(Optional)"})]}),(0,r.jsx)("input",{className:"w-full text-base px-4 py-2 border  border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:m,onChange:e=>{var a;let t=(null===(a=e.target)||void 0===a?void 0:a.files[0])||null;y(t)}}),(0,r.jsx)("input",{type:"hidden",id:a,...t(i,{required:l})}),(0,r.jsxs)("div",{className:"flex gap-4 mt-2",children:[w&&"image"===x&&(0,r.jsx)(n(),{className:"rounded-lg",src:w,width:100,height:100,alt:""}),p&&"file"!==i&&"file_materi"!==i&&(0,r.jsx)("div",{children:(0,r.jsx)(n(),{src:"".concat(s._n,"/").concat(p),width:100,height:100,alt:""})})]}),(null==u?void 0:u.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[a," tidak boleh kosong"]})]})}},9247:function(e,a,t){"use strict";var r=t(9268),s=t(6006),l=t(480),n=t(9700);a.Z=e=>{let{label:a,control:t,required:d,name:i,errors:o,addClass:u,menuPosition:c="fixed",placeholder:m="Pilih Tahun",options:h=[]}=e,[p,f]=(0,s.useState)(null);return(0,s.useEffect)(()=>{"undefined"!=typeof document&&f(document.body)},[]),(0,r.jsxs)("div",{className:u,children:[a&&(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:a}),d&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),p&&(0,r.jsx)(n.Qr,{name:i,control:t,rules:{required:d},render:e=>{let{field:{onChange:a,value:t,name:s,ref:n}}=e;return(0,r.jsx)(l.ZP,{isClearable:!0,isSearchable:!0,options:h,placeholder:m,menuPosition:c,ref:n,value:t?h.find(e=>e.value===t):t,onChange:e=>a(e?e.value:e),menuPlacement:"auto",menuPortalTarget:document.body})}}),(null==o?void 0:o.type)==="required"&&(0,r.jsx)("p",{className:"text-red-500 font-inter italic text-sm",children:"Tahun tidak boleh kosong"})]})}},4496:function(e,a,t){"use strict";var r=t(9268),s=t(3336),l=t(9700);a.Z=e=>{let{dataDb:a,body:t,control:n,required:d,name:i,errors:o,placeholder:u,addClass:c,label:m,defaultOptions:h=!0,menuPosition:p="fixed"}=e,f={multiValue:(e,a)=>a.data.isFixed?{...e,backgroundColor:"gray"}:e,multiValueLabel:(e,a)=>a.data.isFixed?{...e,fontWeight:"bold",color:"white",paddingRight:6}:e,multiValueRemove:(e,a)=>a.data.isFixed?{...e,display:"none"}:e},g=(e,a)=>{let t=e[a];if("id"===a)return{value:t,label:""};if("NPM_FULL"===a){var r;let a=null==e?void 0:null===(r=e.thn_angkatan)||void 0===r?void 0:r.substring(2),t=e.prodi,s=e.NPM,l="".concat(t.kode).concat(a.substring(2)).concat(s);return{value:e.NPM,label:l}}if(!a.includes("."))return{value:"",label:t};{let[t,...r]=a.split("."),s=e[t];return g(s,r.join("."))}},x=()=>{let e=a&&a.map((e,a)=>{let r=t.map(a=>g(e,a)),s=r.map(e=>e.label).filter(e=>""!==e),l=s.join(s.length>1?" - ":"");return{value:r.find(e=>""!==e.value).value,label:l}});return e},b=e=>{var a;return null===(a=x())||void 0===a?void 0:a.filter(a=>a.label.toLowerCase().includes(e.toLowerCase()))},w=(e,a)=>{setTimeout(()=>{a(b(e))},1e3)};return(0,r.jsxs)("div",{className:c,children:[m&&(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:m}),d&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,r.jsx)(l.Qr,{name:i,control:n,rules:{required:d},render:e=>{var a;let{field:{onChange:t,value:l,ref:n}}=e;return(0,r.jsx)(s.Z,{cacheOptions:!0,defaultOptions:h,isClearable:!0,isSearchable:!0,loadOptions:w,placeholder:u,menuPlacement:"auto",menuPosition:p,styles:f,ref:n,value:(null===(a=x())||void 0===a?void 0:a.find(e=>e.value===l))||null,onChange:e=>t(e?e.value:e),menuPortalTarget:document.body})}}),(null==o?void 0:o.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[m," tidak boleh kosong"]})]})}},4407:function(e,a,t){"use strict";var r=t(9268),s=t(6006),l=t(480),n=t(5326),d=t.n(n),i=t(9700);a.Z=e=>{let{label:a,start:t=2012,end:n=d()().format("YYYY"),control:o,required:u,name:c,errors:m,addClass:h,menuPosition:p="fixed",placeholder:f="Pilih Tahun",fromMax:g=!1}=e,x=()=>{let e=[];if(g)for(let a=n;a>=t;a--)e.push({value:a,label:a});else for(let a=t;a<=n;a++)e.push({value:a,label:a});return e},[b,w]=(0,s.useState)(null);return(0,s.useEffect)(()=>{"undefined"!=typeof document&&w(document.body)},[]),(0,r.jsxs)("div",{className:h,children:[a&&(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:a}),u&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),b&&(0,r.jsx)(i.Qr,{name:c,control:o,rules:{required:u},render:e=>{let{field:{onChange:a,value:t,name:s,ref:n}}=e;return(0,r.jsx)(l.ZP,{isClearable:!0,isSearchable:!0,options:x(),placeholder:f,menuPosition:p,ref:n,value:t?x().find(e=>e.value===t):t,onChange:e=>a(e?e.value:e)})}}),(null==m?void 0:m.type)==="required"&&(0,r.jsx)("p",{className:"text-red-500 font-inter italic text-sm",children:"Tahun tidak boleh kosong"})]})}},1468:function(e,a,t){"use strict";var r=t(2561),s=t(4475),l=t(3415);let n=(0,r.Ue)((0,s.mW)((e,a)=>({dtJadwal:[],setJadwal:async a=>{let{page:t=1,limit:r=10,search:s,tahun:n,semester:d,prodi_id:i}=a;try{let a=await (0,l.cB)({method:"get",url:"/jadwal",params:{limit:r,page:t,search:s,tahun:n,semester:d,prodi_id:i}});return e(e=>({...e,dtJadwal:a.data.data})),{status:"berhasil",data:a.data}}catch(e){return{status:"error",error:e.response.data}}},setJadwalAll:async a=>{let{search:t}=a;try{let a=await (0,l.cB)({method:"get",url:"/jadwal/all",params:{search:t}});return e(e=>({...e,dtJadwal:a.data})),{status:"berhasil",data:a.data}}catch(e){return{status:"error",error:e.response.data}}},setJadwalByDosenFull:async a=>{let{tahun:t,semester:r,dosen_id:s}=a;try{let a=await (0,l.cB)({method:"get",url:"/jadwal/byDosenFull",params:{tahun:t,semester:r,dosen_id:s}});return e(e=>({...e,dtJadwal:null==a?void 0:a.data})),{status:"berhasil",data:a.data}}catch(e){return{status:"error",error:e.response.data}}},setByTahunSemester:async a=>{let{search:t,tahun:r,semester:s,prodi_id:n}=a;try{let a=await (0,l.cB)({method:"get",url:"/jadwal/byTahunSemester",params:{search:t,tahun:r,semester:s,prodi_id:n}});return e(e=>({...e,dtJadwal:a.data.data})),{status:"berhasil",data:a.data}}catch(e){return{status:"error",error:e.response.data}}},setJadwalByRps:async a=>{let{tahun:t,semester:r,dosen_id:s}=a;try{let a=await (0,l.cB)({method:"get",url:"/jadwal/by-rps",params:{dosen_id:s}});return e(e=>({...e,dtJadwal:null==a?void 0:a.data})),{status:"berhasil",data:a.data}}catch(e){return{status:"error",error:e.response.data}}},setShowJadwal:async a=>{try{let t=await (0,l.cB)({method:"get",url:"/jadwal/".concat(a)});return e(e=>({...e,dtJadwal:t.data.data})),{status:"berhasil",data:t.data}}catch(e){return{status:"error",error:e.response.data}}}})));a.Z=n},2775:function(e,a,t){"use strict";var r=t(2561),s=t(4475),l=t(3415),n=t(4406);let d=(0,r.Ue)((0,s.mW)((e,a)=>({setFormData:e=>{let a=new FormData;return a.append("jadwal_id",e.jadwal_id),a.append("file",e.file),a},dtAbsen:{last_page:0,current_page:0,data:[]},showAbsen:[],setAbsen:async a=>{let{page:t=1,limit:r=10,semester:s,tahun:d,prodi_id:i,dosen_id:o,search:u}=a;try{let a=await n.Z.getState().setToken(),c=await (0,l.Sj)({method:"get",url:"/upload/absen",headers:{Authorization:"Bearer ".concat(a)},params:{limit:r,page:t,semester:s,tahun:d,prodi_id:i,dosen_id:o,search:u}});return e(e=>({...e,dtAbsen:c.data})),{status:"berhasil",data:c.data}}catch(e){var c;return{status:"error",error:null===(c=e.response)||void 0===c?void 0:c.data}}},setShowAbsen:async a=>{let{id:t}=a;try{let a=await n.Z.getState().setToken(),r=await (0,l.Sj)({method:"get",url:"/upload/absen/".concat(t),headers:{Authorization:"Bearer ".concat(a)},params:{}});return e(e=>({...e,showAbsen:r.data.data})),{status:"berhasil",data:r.data}}catch(e){var r;return{status:"error",error:null===(r=e.response)||void 0===r?void 0:r.data}}},addData:async t=>{let r=(null==t?void 0:t.file)?a().setFormData(t):t;try{let a=await n.Z.getState().setToken(),t=await (0,l.Sj)({method:"post",url:"/upload/absen",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"multipart/form-data"},data:r});return e(e=>({dtAbsen:{last_page:e.dtAbsen.last_page,current_page:e.dtAbsen.current_page,data:[t.data.data,...e.dtAbsen.data]}})),{status:"berhasil tambah",data:t.data}}catch(e){return{status:"error",data:e.response.data}}},removeData:async a=>{try{let t=await n.Z.getState().setToken(),r=await (0,l.Sj)({method:"delete",url:"/upload/absen/".concat(a),headers:{Authorization:"Bearer ".concat(t)}});return e(e=>({dtAbsen:{last_page:e.dtAbsen.last_page,current_page:e.dtAbsen.current_page,data:e.dtAbsen.data.filter(e=>e.id!==a)}})),{status:"berhasil hapus",data:r.data}}catch(e){return{status:"error",data:e.response.data}}},updateData:async(t,r)=>{delete r.id;let s=(null==r?void 0:r.file)?a().setFormData(r):r,d=await n.Z.getState().setToken();try{let a=await (0,l.Sj)({url:"/upload/absen/".concat(t),method:"post",headers:(null==r?void 0:r.file)?{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(d)}:{Authorization:"Bearer ".concat(d)},data:s,params:{_method:"PUT"}});return e(e=>({dtAbsen:{last_page:e.dtAbsen.last_page,current_page:e.dtAbsen.current_page,data:e.dtAbsen.data.map(e=>e.id===t?{...e,...a.data.data}:e)}})),{status:"berhasil update",data:a.data}}catch(e){return{status:"error",data:e.response.data}}}})));a.Z=d},9099:function(e,a,t){"use strict";t.d(a,{w:function(){return s.a}});var r=t(5326),s=t.n(r);t(4215)}},function(e){e.O(0,[6680,4550,4288,1053,831,5243,3088,2771,4272,9253,7698,1744],function(){return e(e.s=2121)}),_N_E=e.O()}]);