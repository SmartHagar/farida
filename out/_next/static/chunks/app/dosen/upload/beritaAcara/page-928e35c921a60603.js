(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2249],{3927:function(a,e,t){Promise.resolve().then(t.bind(t,8090))},8090:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return y}});var r=t(9268),l=t(6006),s=t(1712),i=t(593),d=t(3346),n=t(9114),o=t(1468),u=a=>{let{setDelete:e,setEdit:t,search:u,tahunWatch:c,semesterWatch:h}=a,m=s.Z.get("dosen_id")||"",{setShowBeritaAcara:p,showBeritaAcara:w}=(0,n.Z)(),{setJadwalByDosenFull:f,dtJadwal:v}=(0,o.Z)(),[j,x]=(0,l.useState)(1),[b,g]=(0,l.useState)(10),[y,S]=(0,l.useState)(!0),[k,B]=(0,l.useState)(),Z=async()=>{S(!0),await f({dosen_id:m,search:u,tahun:c,semester:h}),S(!1)};(0,l.useMemo)(()=>c&&h&&Z(),[m,c,h]);let _=async()=>{var a;let e=[];null==v||null===(a=v.data)||void 0===a||a.map(a=>{e.push(a.id)});let t=e.join(",");e.length>0&&await p({id:m,jadwal_id:t})};(0,l.useEffect)(()=>{_()},[JSON.stringify(v)]);let N=(a,e)=>{console.log({dtJadwal:a,showBeritaAcara:e});let t=null==e?void 0:e.map(e=>{let t=null==a?void 0:a.find(a=>a.id===parseInt(e.berita_acara.jadwal_id));return t?{...e,jadwal:t}:null}).filter(a=>null!==a);B({data:t}),S(!1)};return(0,l.useEffect)(()=>{var a;(null==v?void 0:null===(a=v.data)||void 0===a?void 0:a.length)>0&&N(null==v?void 0:v.data,w)},[JSON.stringify(w),JSON.stringify(v)]),(0,r.jsx)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:y?(0,r.jsx)(i.Z,{}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"",children:(0,r.jsx)(d.Z,{headTable:["No","Hari","Mata Kuliah","Kode MK","JML. SKS","BERITA ACARA","Aksi"],tableBodies:["jadwal.hari","jadwal.matkul.nama","jadwal.matkul.kode","jadwal.matkul.sks","file"],dataTable:null==k?void 0:k.data,page:j,limit:b,setEdit:t,setDelete:e,hapus:!0,ubah:!0})})})})},c=t(2985),h=t(7808),m=t(9442),p=t(9700),w=t(63),f=t(4496);t(6760);var v=a=>{let{register:e,errors:t,control:i,dtEdit:d,watch:n,setValue:u,showModal:c,myFile:h,setMyFile:m,tahunWatch:p,semesterWatch:v}=a;s.Z.get("dosen_id");let{setJadwalByDosenFull:j,dtJadwal:x}=(0,o.Z)(),[b,g]=(0,l.useState)();return(0,r.jsxs)(r.Fragment,{children:[(null==b?void 0:b.data)&&(0,r.jsx)(f.Z,{label:"Jadwal",placeholder:"Pilih Jadwal",name:"berita_acara_id",dataDb:null==b?void 0:b.data,body:["id","jadwal.matkul.kode","jadwal.hari","jadwal.matkul.nama","jadwal.mulai","jadwal.seles"],control:i,required:!0,errors:t.berita_acara_id,addClass:"col-span-4"}),(0,r.jsx)(w.Z,{label:"Berita Acara",name:"file",register:e,accept:"application/pdf",required:!0,errors:t.file,addClass:"col-span-4",setValue:u,fileEdit:null==d?void 0:d.file,watch:n})]})},j=t(541),x=a=>{let{showModal:e,setShowModal:t,dtEdit:s,tahunWatch:d,semesterWatch:o}=a,[u,w]=(0,l.useState)(),{addData:f,updateData:x}=(0,n.Z)(),[b,g]=(0,l.useState)(!1),{register:y,handleSubmit:S,setValue:k,control:B,formState:{errors:Z},watch:_}=(0,p.cI)(),N=()=>{k("id",""),k("berita_acara_id",""),k("file",""),w(null)};(0,l.useEffect)(()=>{s?(k("id",s.id),k("berita_acara_id",parseInt(s.berita_acara_id)),k("file",s.file)):N()},[e,s]);let A=async a=>{if(g(!0),console.log({row:a}),s){let{data:e}=await x(s.id,a);(0,m.Z)({event:e}),t(!1)}else{let{data:e}=await f(a);console.log({data:e}),(0,m.Z)({event:e}),(null==e?void 0:e.type)!=="success"||N()}g(!1)};return(0,r.jsx)(h.Z,{title:"Form Dosen",showModal:e,setShowModal:t,children:(0,r.jsxs)("form",{onSubmit:S(A),children:[(0,r.jsx)(c.Z,{name:"id",register:y,type:"hidden"}),(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,r.jsx)(v,{register:y,errors:Z,dtEdit:s,control:B,watch:_,setValue:k,showModal:e,myFile:u,setMyFile:w,tahunWatch:d,semesterWatch:o})}),(0,r.jsx)("div",{children:b?(0,r.jsx)(i.Z,{}):(0,r.jsx)(j.Z,{onClick:S(A),children:"Simpan"})})]})})},b=t(686),g=t(8919),y=()=>{let{removeData:a}=(0,n.Z)(),[e,t]=(0,l.useState)(!1),[s,i]=(0,l.useState)(!1),[d,o]=(0,l.useState)(),[c,h]=(0,l.useState)(),[w,f]=(0,l.useState)(""),[v,y]=(0,l.useState)(""),[S,k]=(0,l.useState)(""),B=async e=>{let{id:t,isDelete:r}=e;if(o(t),r){let{data:e}=await a(d);(0,m.Z)({event:e}),i(!1)}else i(!0)},{register:Z,control:_,formState:{errors:N},watch:A,setValue:D}=(0,p.cI)();return(0,l.useEffect)(()=>{let a=new Date().getFullYear(),e=new Date().getMonth();return y(a),k(e>6?"Ganjil":"Genap"),()=>{}},[]),(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(g.Toaster,{}),(0,r.jsx)(x,{dtEdit:c,showModal:e,setShowModal:t,tahunWatch:v,semesterWatch:S}),(0,r.jsx)(b.Z,{showDel:s,setShowDel:i,setDelete:B}),(0,r.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,r.jsx)("p",{children:"Silahkan mengolah data berita acara"}),(0,r.jsx)("div",{children:(0,r.jsx)(j.Z,{onClick:()=>{t(!0),h(null)},children:"Tambah berita acara"})})]})]}),(0,r.jsx)(u,{setDelete:B,setEdit:a=>{t(!0),h(a)},search:w,tahunWatch:v,semesterWatch:S})]})}},63:function(a,e,t){"use strict";var r=t(9268),l=t(3415),s=t(6394),i=t.n(s),d=t(6006),n=t(5883),o=t.n(n);e.Z=a=>{let{label:e,register:t,required:s,name:n,errors:u,addClass:c,accept:h,setValue:m,fileEdit:p,initialValue:w,watch:f}=a,[v,j]=(0,d.useState)(),[x,b]=(0,d.useState)(w||""),g=f(n);(0,d.useEffect)(()=>{g||b("")},[g]);let y=a=>new Promise(()=>{if(a){var e;let t=(null==a?void 0:null===(e=a.type)||void 0===e?void 0:e.split("/"))||[],r=t[0];if("image"!==r)return S(a);o().imageFileResizer(a,1500,1500,t[1],80,0,a=>{S(a)},"file")}else S(null)}),S=a=>{var e;if(a){let e=new FileReader;e.readAsDataURL(a),e.onloadend=()=>{b(e.result)}}let t=(null==a?void 0:null===(e=a.type)||void 0===e?void 0:e.split("/"))||[];j(t[0]),m(n,a)};return(0,r.jsxs)("div",{className:c,children:[e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:e}),s&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),!s&&(0,r.jsx)("span",{className:"ml-1 text-gray-500 text-sm",children:"(Optional)"})]}),(0,r.jsx)("input",{className:"w-full text-base px-4 py-2 border  border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:h,onChange:a=>{var e;let t=(null===(e=a.target)||void 0===e?void 0:e.files[0])||null;y(t)}}),(0,r.jsx)("input",{type:"hidden",id:e,...t(n,{required:s})}),(0,r.jsxs)("div",{className:"flex gap-4 mt-2",children:[x&&"image"===v&&(0,r.jsx)(i(),{className:"rounded-lg",src:x,width:100,height:100,alt:""}),p&&"file"!==n&&"file_materi"!==n&&(0,r.jsx)("div",{children:(0,r.jsx)(i(),{src:"".concat(l._n,"/").concat(p),width:100,height:100,alt:""})})]}),(null==u?void 0:u.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[e," tidak boleh kosong"]})]})}},4496:function(a,e,t){"use strict";var r=t(9268),l=t(3336),s=t(9700);e.Z=a=>{let{dataDb:e,body:t,control:i,required:d,name:n,errors:o,placeholder:u,addClass:c,label:h,defaultOptions:m=!0,menuPosition:p="fixed"}=a,w={multiValue:(a,e)=>e.data.isFixed?{...a,backgroundColor:"gray"}:a,multiValueLabel:(a,e)=>e.data.isFixed?{...a,fontWeight:"bold",color:"white",paddingRight:6}:a,multiValueRemove:(a,e)=>e.data.isFixed?{...a,display:"none"}:a},f=(a,e)=>{let t=a[e];if("id"===e)return{value:t,label:""};if("NPM_FULL"===e){var r;let e=null==a?void 0:null===(r=a.thn_angkatan)||void 0===r?void 0:r.substring(2),t=a.prodi,l=a.NPM,s="".concat(t.kode).concat(e.substring(2)).concat(l);return{value:a.NPM,label:s}}if(!e.includes("."))return{value:"",label:t};{let[t,...r]=e.split("."),l=a[t];return f(l,r.join("."))}},v=()=>{let a=e&&e.map((a,e)=>{let r=t.map(e=>f(a,e)),l=r.map(a=>a.label).filter(a=>""!==a),s=l.join(l.length>1?" - ":"");return{value:r.find(a=>""!==a.value).value,label:s}});return a},j=a=>{var e;return null===(e=v())||void 0===e?void 0:e.filter(e=>e.label.toLowerCase().includes(a.toLowerCase()))},x=(a,e)=>{setTimeout(()=>{e(j(a))},1e3)};return(0,r.jsxs)("div",{className:c,children:[h&&(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:h}),d&&(0,r.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,r.jsx)(s.Qr,{name:n,control:i,rules:{required:d},render:a=>{var e;let{field:{onChange:t,value:s,ref:i}}=a;return(0,r.jsx)(l.Z,{cacheOptions:!0,defaultOptions:m,isClearable:!0,isSearchable:!0,loadOptions:x,placeholder:u,menuPlacement:"auto",menuPosition:p,styles:w,ref:i,value:(null===(e=v())||void 0===e?void 0:e.find(a=>a.value===s))||null,onChange:a=>t(a?a.value:a),menuPortalTarget:document.body})}}),(null==o?void 0:o.type)==="required"&&(0,r.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[h," tidak boleh kosong"]})]})}},1468:function(a,e,t){"use strict";var r=t(2561),l=t(4475),s=t(3415);let i=(0,r.Ue)((0,l.mW)((a,e)=>({dtJadwal:[],setJadwal:async e=>{let{page:t=1,limit:r=10,search:l,tahun:i,semester:d,prodi_id:n}=e;try{let e=await (0,s.cB)({method:"get",url:"/jadwal",params:{limit:r,page:t,search:l,tahun:i,semester:d,prodi_id:n}});return a(a=>({...a,dtJadwal:e.data.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setJadwalAll:async e=>{let{search:t}=e;try{let e=await (0,s.cB)({method:"get",url:"/jadwal/all",params:{search:t}});return a(a=>({...a,dtJadwal:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setJadwalByDosenFull:async e=>{let{tahun:t,semester:r,dosen_id:l}=e;try{let e=await (0,s.cB)({method:"get",url:"/jadwal/byDosenFull",params:{tahun:t,semester:r,dosen_id:l}});return a(a=>({...a,dtJadwal:null==e?void 0:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setByTahunSemester:async e=>{let{search:t,tahun:r,semester:l,prodi_id:i}=e;try{let e=await (0,s.cB)({method:"get",url:"/jadwal/byTahunSemester",params:{search:t,tahun:r,semester:l,prodi_id:i}});return a(a=>({...a,dtJadwal:e.data.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setJadwalByRps:async e=>{let{tahun:t,semester:r,dosen_id:l}=e;try{let e=await (0,s.cB)({method:"get",url:"/jadwal/by-rps",params:{dosen_id:l}});return a(a=>({...a,dtJadwal:null==e?void 0:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setShowJadwal:async e=>{try{let t=await (0,s.cB)({method:"get",url:"/jadwal/".concat(e)});return a(a=>({...a,dtJadwal:t.data.data})),{status:"berhasil",data:t.data}}catch(a){return{status:"error",error:a.response.data}}}})));e.Z=i},9114:function(a,e,t){"use strict";var r=t(2561),l=t(4475),s=t(3415),i=t(4406);let d=(0,r.Ue)((0,l.mW)((a,e)=>({setFormData:a=>{let e=new FormData;return e.append("berita_acara_id",a.berita_acara_id),e.append("file",a.file),e},dtBeritaAcara:[],showBeritaAcara:[],setBeritaAcara:async e=>{let{page:t=1,limit:r=10,semester:l,tahun:d,prodi_id:n,dosen_id:o,search:u}=e;try{let e=await i.Z.getState().setToken(),c=await (0,s.Sj)({method:"get",url:"/upload/berita-acara",headers:{Authorization:"Bearer ".concat(e)},params:{limit:r,page:t,semester:l,tahun:d,prodi_id:n,dosen_id:o,search:u}});return a(a=>({...a,dtBeritaAcara:c.data})),{status:"berhasil",data:c.data}}catch(a){var c;return{status:"error",error:null===(c=a.response)||void 0===c?void 0:c.data}}},setShowBeritaAcara:async e=>{let{id:t,jadwal_id:r}=e;try{let e=await i.Z.getState().setToken(),l=await (0,s.Sj)({method:"get",url:"/upload/berita-acara/".concat(t),headers:{Authorization:"Bearer ".concat(e)},params:{jadwal_id:r}});return a(a=>({...a,showBeritaAcara:l.data.data})),{status:"berhasil",data:l.data}}catch(a){var l;return{status:"error",error:null===(l=a.response)||void 0===l?void 0:l.data}}},addData:async t=>{let r=(null==t?void 0:t.file)?e().setFormData(t):t;try{let e=await i.Z.getState().setToken(),t=await (0,s.Sj)({method:"post",url:"/upload/berita-acara",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"},data:r});return a(a=>({showBeritaAcara:[t.data.data,...a.showBeritaAcara]})),{status:"berhasil tambah",data:t.data}}catch(a){return{status:"error",data:a.response.data}}},removeData:async e=>{try{let t=await i.Z.getState().setToken(),r=await (0,s.Sj)({method:"delete",url:"/upload/berita-acara/".concat(e),headers:{Authorization:"Bearer ".concat(t)}});return a(a=>({showBeritaAcara:a.showBeritaAcara.filter(a=>a.id!==e)})),{status:"berhasil hapus",data:r.data}}catch(a){return{status:"error",data:a.response.data}}},updateData:async(t,r)=>{delete r.id;let l=(null==r?void 0:r.file)?e().setFormData(r):r,d=await i.Z.getState().setToken();try{let e=await (0,s.Sj)({url:"/upload/berita-acara/".concat(t),method:"post",headers:(null==r?void 0:r.file)?{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(d)}:{Authorization:"Bearer ".concat(d)},data:l,params:{_method:"PUT"}});return a(a=>({showBeritaAcara:a.showBeritaAcara.map(a=>a.id===t?{...a,...e.data.data}:a)})),{status:"berhasil update",data:e.data}}catch(a){return{status:"error",data:a.response.data}}}})));e.Z=d}},function(a){a.O(0,[6680,4550,4288,1053,831,5243,3088,1217,4272,9253,7698,1744],function(){return a(a.s=3927)}),_N_E=a.O()}]);